<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2021-02-26T21:02:40-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Penalty method</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link href="developer.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="numerical-methods.html"><span class="title">Numerical Methods with Programming</span></a></h1>
<p class="byline">Leonid Kovalev</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="chapter-constrained-optimization.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chapter-constrained-optimization.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="section-lagrange-multiplier.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="chapter-constrained-optimization.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chapter-constrained-optimization.html" title="Up">Up</a><a class="next-button button toolbar-item" href="section-lagrange-multiplier.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Front Matter</span></a><ul>
<li><a href="acknowledgement.html" data-scroll="acknowledgement">Acknowledgements</a></li>
<li><a href="preface.html" data-scroll="preface">Preface</a></li>
</ul>
</li>
<li class="link part"><a href="part-matlab.html" data-scroll="part-matlab"><span class="codenumber">I</span> <span class="title">Using Matlab</span></a></li>
<li class="link">
<a href="chapter-scalars-vectors-matrices.html" data-scroll="chapter-scalars-vectors-matrices"><span class="codenumber">1</span> <span class="title">Scalars, vectors and matrices</span></a><ul>
<li><a href="section-matlab-interface.html" data-scroll="section-matlab-interface">Matlab interface</a></li>
<li><a href="section-scalars.html" data-scroll="section-scalars">Assigning scalar values</a></li>
<li><a href="section-vectors-matrices.html" data-scroll="section-vectors-matrices">Creating vectors and matrices</a></li>
<li><a href="section-operations-vectors-matrices.html" data-scroll="section-operations-vectors-matrices">Operations on vectors and matrices</a></li>
<li><a href="section-indexing-vectors-matrices.html" data-scroll="section-indexing-vectors-matrices">Accessing the entries of vectors and matrices</a></li>
<li><a href="section-comments-sections.html" data-scroll="section-comments-sections">Comments and sections in a script</a></li>
<li><a href="examples-matrices-vectors.html" data-scroll="examples-matrices-vectors">Examples and questions</a></li>
<li><a href="exercises-matrices-vectors.html" data-scroll="exercises-matrices-vectors">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-systems-vectorization-plots.html" data-scroll="chapter-systems-vectorization-plots"><span class="codenumber">2</span> <span class="title">Linear systems, array operations, plots</span></a><ul>
<li><a href="section-linear-systems.html" data-scroll="section-linear-systems">Systems of linear equations</a></li>
<li><a href="section-large-matrices.html" data-scroll="section-large-matrices">More tools for constructing matrices</a></li>
<li><a href="section-vectorization.html" data-scroll="section-vectorization">Array operations</a></li>
<li><a href="section-plotting.html" data-scroll="section-plotting">Plotting</a></li>
<li><a href="examples-systems-vectorization-plots.html" data-scroll="examples-systems-vectorization-plots">Examples and questions</a></li>
<li><a href="exercises-systems-vectorization-plots.html" data-scroll="exercises-systems-vectorization-plots">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-functions-input-output.html" data-scroll="chapter-functions-input-output"><span class="codenumber">3</span> <span class="title">Built-in functions, input, output</span></a><ul>
<li><a href="section-builtin-functions.html" data-scroll="section-builtin-functions">Built-in functions</a></li>
<li><a href="section-random-numbers-histograms.html" data-scroll="section-random-numbers-histograms">Random numbers and histograms</a></li>
<li><a href="section-user-input.html" data-scroll="section-user-input">User input</a></li>
<li><a href="section-formatted-output.html" data-scroll="section-formatted-output">Formatted output</a></li>
<li><a href="examples-functions-input-output.html" data-scroll="examples-functions-input-output">Examples and questions</a></li>
<li><a href="exercises-functions-input-output.html" data-scroll="exercises-functions-input-output">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-control-flow.html" data-scroll="chapter-control-flow"><span class="codenumber">4</span> <span class="title">Control flow: loops and conditional statements</span></a><ul>
<li><a href="section-for-loop.html" data-scroll="section-for-loop"><code class="code-inline tex2jax_ignore">for</code> loop</a></li>
<li><a href="section-while-loop.html" data-scroll="section-while-loop"><code class="code-inline tex2jax_ignore">while</code> loop</a></li>
<li><a href="section-if-statement.html" data-scroll="section-if-statement"><code class="code-inline tex2jax_ignore">if</code> statement</a></li>
<li><a href="section-break-statement.html" data-scroll="section-break-statement">Breaking out of a loop</a></li>
<li><a href="examples-control-flow.html" data-scroll="examples-control-flow">Examples and questions</a></li>
<li><a href="exercises-control-flow.html" data-scroll="exercises-control-flow">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-user-defined-functions.html" data-scroll="chapter-user-defined-functions"><span class="codenumber">5</span> <span class="title">User-defined functions</span></a><ul>
<li><a href="section-anonymous-functions.html" data-scroll="section-anonymous-functions">Anonymous functions</a></li>
<li><a href="section-named-functions.html" data-scroll="section-named-functions">Named functions</a></li>
<li><a href="examples-user-defined-functions.html" data-scroll="examples-user-defined-functions">Examples and questions</a></li>
<li><a href="exercises-user-defined-functions.html" data-scroll="exercises-user-defined-functions">Homework</a></li>
</ul>
</li>
<li class="link part"><a href="part-equations.html" data-scroll="part-equations"><span class="codenumber">II</span> <span class="title">Solving Equations</span></a></li>
<li class="link">
<a href="chapter-linear-systems.html" data-scroll="chapter-linear-systems"><span class="codenumber">6</span> <span class="title">Systems of linear equations</span></a><ul>
<li><a href="section-classification-linear-systems.html" data-scroll="section-classification-linear-systems">Classification of linear systems</a></li>
<li><a href="section-systems-without-free-variables.html" data-scroll="section-systems-without-free-variables">Systems without free variables</a></li>
<li><a href="section-systems-with-free-variables.html" data-scroll="section-systems-with-free-variables">Systems with free variables</a></li>
<li><a href="section-round-off.html" data-scroll="section-round-off">The effect of round-off errors</a></li>
<li><a href="examples-linear-systems.html" data-scroll="examples-linear-systems">Examples and questions</a></li>
<li><a href="exercises-linear-systems.html" data-scroll="exercises-linear-systems">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-roots-bisection.html" data-scroll="chapter-roots-bisection"><span class="codenumber">7</span> <span class="title">Root finding: bisection</span></a><ul>
<li><a href="section-motivation-numeric-solution.html" data-scroll="section-motivation-numeric-solution">Motivation for solving equations numerically</a></li>
<li><a href="section-meaning-numeric-solution.html" data-scroll="section-meaning-numeric-solution">The meaning of a numeric solution</a></li>
<li><a href="section-bisection-method.html" data-scroll="section-bisection-method">Bisection method</a></li>
<li><a href="section-bisection-issues.html" data-scroll="section-bisection-issues">Limitations of the bisection method</a></li>
<li><a href="examples-roots-bisection.html" data-scroll="examples-roots-bisection">Examples and questions</a></li>
<li><a href="exercises-roots-bisection.html" data-scroll="exercises-roots-bisection">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-fixed-point-iteration.html" data-scroll="chapter-fixed-point-iteration"><span class="codenumber">8</span> <span class="title">Root finding: fixed point iteration</span></a><ul>
<li><a href="section-classification-fixed-points.html" data-scroll="section-classification-fixed-points">Classification of fixed points</a></li>
<li><a href="section-rewriting-fixed-point.html" data-scroll="section-rewriting-fixed-point">Rewriting equations in the fixed-point form</a></li>
<li><a href="section-rate-convergence.html" data-scroll="section-rate-convergence">The speed of convergence of fixed-point iteration</a></li>
<li><a href="examples-fixed-point-iteration.html" data-scroll="examples-fixed-point-iteration">Examples and questions</a></li>
<li><a href="exercises-fixed-point-iteration.html" data-scroll="exercises-fixed-point-iteration">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-newton-secant.html" data-scroll="chapter-newton-secant"><span class="codenumber">9</span> <span class="title">Newton's method and secant method</span></a><ul>
<li><a href="section-newton-method-intro.html" data-scroll="section-newton-method-intro">Newton's method</a></li>
<li><a href="section-newton-method-issues.html" data-scroll="section-newton-method-issues">Potential issues with Newton's method</a></li>
<li><a href="section-secant-method.html" data-scroll="section-secant-method">The secant method</a></li>
<li><a href="section-relaxation-parameter.html" data-scroll="section-relaxation-parameter">The relaxation parameter</a></li>
<li><a href="examples-newton-secant.html" data-scroll="examples-newton-secant">Examples and questions</a></li>
<li><a href="exercises-newton-secant.html" data-scroll="exercises-newton-secant">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-multivariate-newton.html" data-scroll="chapter-multivariate-newton"><span class="codenumber">10</span> <span class="title">Systems of several nonlinear equations: multivariate Newton's method</span></a><ul>
<li><a href="section-nonlinear-systems.html" data-scroll="section-nonlinear-systems">Systems of nonlinear equations</a></li>
<li><a href="section-multivariate-newton.html" data-scroll="section-multivariate-newton">Multivariate Newton's method</a></li>
<li><a href="section-multivariate-newton-method-issues.html" data-scroll="section-multivariate-newton-method-issues">Potential issues</a></li>
<li><a href="examples-multivariate-newton.html" data-scroll="examples-multivariate-newton">Examples and questions</a></li>
<li><a href="exercises-multivariate-newton.html" data-scroll="exercises-multivariate-newton">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-broyden.html" data-scroll="chapter-broyden"><span class="codenumber">11</span> <span class="title">Broyden's method</span></a><ul>
<li><a href="section-broyden-intro.html" data-scroll="section-broyden-intro">Idea of Broyden's method</a></li>
<li><a href="section-broyden-linear-algebra.html" data-scroll="section-broyden-linear-algebra">Outer products</a></li>
<li><a href="section-broyden-method.html" data-scroll="section-broyden-method">Details of Broyden's method</a></li>
<li><a href="examples-broyden.html" data-scroll="examples-broyden">Examples and questions</a></li>
<li><a href="exercises-broyden.html" data-scroll="exercises-broyden">Homework</a></li>
</ul>
</li>
<li class="link part"><a href="part-calculus.html" data-scroll="part-calculus"><span class="codenumber">III</span> <span class="title">Numerical Calculus</span></a></li>
<li class="link">
<a href="chapter-numerical-differentiation.html" data-scroll="chapter-numerical-differentiation"><span class="codenumber">12</span> <span class="title">Numerical Differentiation</span></a><ul>
<li><a href="section-differentiation-intro.html" data-scroll="section-differentiation-intro">Definition of derivative and the order of error</a></li>
<li><a href="section-loss-significance.html" data-scroll="section-loss-significance">Loss of significance</a></li>
<li><a href="section-symmetric-difference.html" data-scroll="section-symmetric-difference">Symmetric difference formulas</a></li>
<li><a href="section-richardson-extrapolation.html" data-scroll="section-richardson-extrapolation">Richardson extrapolation</a></li>
<li><a href="examples-numerical-differentiation.html" data-scroll="examples-numerical-differentiation">Examples and questions</a></li>
<li><a href="exercises-numerical-differentiation.html" data-scroll="exercises-numerical-differentiation">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-trapezoid-midpoint.html" data-scroll="chapter-trapezoid-midpoint"><span class="codenumber">13</span> <span class="title">Numerical integration: basic rules</span></a><ul>
<li><a href="section-riemann-sums.html" data-scroll="section-riemann-sums">Riemann sums</a></li>
<li><a href="section-left-right-midpoint.html" data-scroll="section-left-right-midpoint">Left, right, midpoint rules</a></li>
<li><a href="section-trapezoidal-rulet.html" data-scroll="section-trapezoidal-rulet">Trapezoidal rule</a></li>
<li><a href="section-lrtm-error-estimates.html" data-scroll="section-lrtm-error-estimates">Error estimates</a></li>
<li><a href="examples-trapezoid-midpoint.html" data-scroll="examples-trapezoid-midpoint">Examples and questions</a></li>
<li><a href="exercises-trapezoid-midpoint.html" data-scroll="exercises-trapezoid-midpoint">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-simpson-newton-cotes.html" data-scroll="chapter-simpson-newton-cotes"><span class="codenumber">14</span> <span class="title">Simpson's rule and other Newton-Cotes rules</span></a><ul>
<li><a href="section-simpson-rule.html" data-scroll="section-simpson-rule">Simpson's rule</a></li>
<li><a href="section-newton-cotes.html" data-scroll="section-newton-cotes">Newton-Cotes rules</a></li>
<li><a href="exercises-simpson-newton-cotes.html" data-scroll="exercises-simpson-newton-cotes">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-legendre-laguerre.html" data-scroll="chapter-legendre-laguerre"><span class="codenumber">15</span> <span class="title">Legendre polynomials and Laguerre polynomials</span></a><ul>
<li><a href="section-legendre-motivation.html" data-scroll="section-legendre-motivation">Motivation: search for better evaluation points</a></li>
<li><a href="section-legendre-polynomials.html" data-scroll="section-legendre-polynomials">Legendre polynomials</a></li>
<li><a href="section-laguerre-polynomials.html" data-scroll="section-laguerre-polynomials">Laguerre polynomials</a></li>
<li><a href="examples-legendre-laguerre.html" data-scroll="examples-legendre-laguerre">Examples and questions</a></li>
<li><a href="exercises-legendre-laguerre.html" data-scroll="exercises-legendre-laguerre">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-gaussian-integration.html" data-scroll="chapter-gaussian-integration"><span class="codenumber">16</span> <span class="title">Gauss-Legendre and Gauss-Laguerre integration</span></a><ul>
<li><a href="section-orthogonal-polynomials-recap.html" data-scroll="section-orthogonal-polynomials-recap">Brief recap of orthogonal polynomials</a></li>
<li><a href="section-gauss-legendre.html" data-scroll="section-gauss-legendre">Gauss-Legendre integration</a></li>
<li><a href="section-gauss-laguerre.html" data-scroll="section-gauss-laguerre">Gauss-Laguerre integration</a></li>
<li><a href="examples-gaussian-integration.html" data-scroll="examples-gaussian-integration">Examples and questions</a></li>
<li><a href="exercises-gaussian-integration.html" data-scroll="exercises-gaussian-integration">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-adaptive-integration.html" data-scroll="chapter-adaptive-integration"><span class="codenumber">17</span> <span class="title">Adaptive integration</span></a><ul>
<li><a href="section-motivation-adaptive-integration.html" data-scroll="section-motivation-adaptive-integration">Why we need adaptive methods</a></li>
<li><a href="section-adaptive-integration-error-estimate.html" data-scroll="section-adaptive-integration-error-estimate">Estimating error by using two step sizes</a></li>
<li><a href="section-adaptive-integration-bisection.html" data-scroll="section-adaptive-integration-bisection">Recursive subdivision algorithm</a></li>
<li><a href="section-adaptive-integration-rules.html" data-scroll="section-adaptive-integration-rules">Combining two rules</a></li>
<li><a href="examples-adaptive-integration.html" data-scroll="examples-adaptive-integration">Examples and questions</a></li>
<li><a href="exercises-adaptive-integration.html" data-scroll="exercises-adaptive-integration">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-multivariable-integration.html" data-scroll="chapter-multivariable-integration"><span class="codenumber">18</span> <span class="title">Multivariable integration</span></a><ul>
<li><a href="section-integration-rectangle.html" data-scroll="section-integration-rectangle">Double integrals over rectangles</a></li>
<li><a href="section-integration-general-2d.html" data-scroll="section-integration-general-2d">Double integrals over general regions</a></li>
<li><a href="section-integration-monte-carlo.html" data-scroll="section-integration-monte-carlo">High-dimensional integration: Monte-Carlo method</a></li>
<li><a href="exercises-multivariable-integration.html" data-scroll="exercises-multivariable-integration">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-ode-euler.html" data-scroll="chapter-ode-euler"><span class="codenumber">19</span> <span class="title">Differential equations: Euler's method and its relatives</span></a><ul>
<li><a href="section-ode-intro.html" data-scroll="section-ode-intro">Ordinary differential equations</a></li>
<li><a href="section-euler-method.html" data-scroll="section-euler-method">Euler's method</a></li>
<li><a href="section-ode-order-accuracy.html" data-scroll="section-ode-order-accuracy">Estimating the accuracy of numeric ODE methods</a></li>
<li><a href="section-ode-euler-improved.html" data-scroll="section-ode-euler-improved">Improving Euler's method</a></li>
<li><a href="section-ode-systems.html" data-scroll="section-ode-systems">Solving systems of differential equations</a></li>
<li><a href="exercises-ode-euler.html" data-scroll="exercises-ode-euler">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-ode-modeling.html" data-scroll="chapter-ode-modeling"><span class="codenumber">20</span> <span class="title">Modeling with differential equations</span></a><ul>
<li><a href="section-ode-epidemiology.html" data-scroll="section-ode-epidemiology">Models of an epidemic</a></li>
<li><a href="section-ode-predator-prey.html" data-scroll="section-ode-predator-prey">Predator-prey models</a></li>
<li><a href="examples-ode-modeling.html" data-scroll="examples-ode-modeling">Examples and questions</a></li>
<li><a href="exercises-ode-modeling.html" data-scroll="exercises-ode-modeling">Homework</a></li>
</ul>
</li>
<li class="link part"><a href="part-data.html" data-scroll="part-data"><span class="codenumber">IV</span> <span class="title">Modeling Data</span></a></li>
<li class="link">
<a href="chapter-polynomial-interpolation.html" data-scroll="chapter-polynomial-interpolation"><span class="codenumber">21</span> <span class="title">Polynomial Interpolation</span></a><ul>
<li><a href="section-monomial-basis.html" data-scroll="section-monomial-basis">Interpolation in the monomial basis</a></li>
<li><a href="section-lagrange-polynomial.html" data-scroll="section-lagrange-polynomial">Lagrange interpolating polynomial</a></li>
<li><a href="section-newton-polynomial.html" data-scroll="section-newton-polynomial">Newton interpolating polynomial</a></li>
<li><a href="exercises-polynomial-interpolation.html" data-scroll="exercises-polynomial-interpolation">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-chebyshev.html" data-scroll="chapter-chebyshev"><span class="codenumber">22</span> <span class="title">Chebyshev Polynomials and Interpolation</span></a><ul>
<li><a href="section-error-polynomial-interpolation.html" data-scroll="section-error-polynomial-interpolation">Estimating the error of polynomial interpolation</a></li>
<li><a href="section-chebyshev-polynomials-interpolation.html" data-scroll="section-chebyshev-polynomials-interpolation">Chebyshev polynomials and interpolation</a></li>
<li><a href="section-chebyshev-extreme-points.html" data-scroll="section-chebyshev-extreme-points">Chebyshev extreme points</a></li>
<li><a href="exercises-chebyshev.html" data-scroll="exercises-chebyshev">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-spline-interpolation.html" data-scroll="chapter-spline-interpolation"><span class="codenumber">23</span> <span class="title">Spline Interpolation</span></a><ul>
<li><a href="section-piecewise-linear-interpolation.html" data-scroll="section-piecewise-linear-interpolation">Piecewise linear interpolation</a></li>
<li><a href="section-cubic-splines.html" data-scroll="section-cubic-splines">Cubic splines</a></li>
<li><a href="section-using-cubic-splines.html" data-scroll="section-using-cubic-splines">Using cubic splines</a></li>
<li><a href="exercises-spline-interpolation.html" data-scroll="exercises-spline-interpolation">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-spline-approximation.html" data-scroll="chapter-spline-approximation"><span class="codenumber">24</span> <span class="title">Spline Approximation</span></a><ul>
<li><a href="section-drawbacks-spline-interpolation.html" data-scroll="section-drawbacks-spline-interpolation">Weak points of spline interpolation</a></li>
<li><a href="section-b-splines.html" data-scroll="section-b-splines">Hat functions and B-splines</a></li>
<li><a href="section-construct-cardinal-splines.html" data-scroll="section-construct-cardinal-splines">Construction of cardinal B-splines</a></li>
<li><a href="exercises-spline-approximation.html" data-scroll="exercises-spline-approximation">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-discrete-fourier-transform.html" data-scroll="chapter-discrete-fourier-transform"><span class="codenumber">25</span> <span class="title">Discrete Fourier Transform</span></a><ul>
<li><a href="section-periodic-functions.html" data-scroll="section-periodic-functions">Periodic functions and trigonometric polynomials</a></li>
<li><a href="section-fourier-series.html" data-scroll="section-fourier-series">Fourier series</a></li>
<li><a href="section-discrete-fourier-transform.html" data-scroll="section-discrete-fourier-transform">Discrete Fourier Transform</a></li>
<li><a href="section-trigonometric-interpolation.html" data-scroll="section-trigonometric-interpolation">Trigonometric Interpolation</a></li>
<li><a href="exercises-discrete-fourier-transform.html" data-scroll="exercises-discrete-fourier-transform">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-dft-applications.html" data-scroll="chapter-dft-applications"><span class="codenumber">26</span> <span class="title">Applications of Discrete Fourier Transform</span></a><ul>
<li><a href="section-image-compression.html" data-scroll="section-image-compression">Working with images in Matlab</a></li>
<li><a href="section-2d-dft.html" data-scroll="section-2d-dft">Two-dimensional DFT</a></li>
<li><a href="section-cosine-interpolation.html" data-scroll="section-cosine-interpolation">Cosine interpolation of non-periodic functions</a></li>
<li><a href="exercises-dft-applications.html" data-scroll="exercises-dft-applications">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-linear-least-squares.html" data-scroll="chapter-linear-least-squares"><span class="codenumber">27</span> <span class="title">Linear Least Squares</span></a><ul>
<li><a href="section-lsq-overview.html" data-scroll="section-lsq-overview">Overview of least squares</a></li>
<li><a href="section-overfitting.html" data-scroll="section-overfitting">Overfitting, training and testing</a></li>
<li><a href="section-standard-error.html" data-scroll="section-standard-error">The standard error of parameters</a></li>
<li><a href="section-multiple-regression.html" data-scroll="section-multiple-regression">Multiple regression</a></li>
<li><a href="exercises-linear-least-squares.html" data-scroll="exercises-linear-least-squares">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-transforming-data.html" data-scroll="chapter-transforming-data"><span class="codenumber">28</span> <span class="title">Transforming Data for LLS</span></a><ul>
<li><a href="section-example-exponential-fit.html" data-scroll="section-example-exponential-fit">Exponential fit</a></li>
<li><a href="section-example-logistic-fit.html" data-scroll="section-example-logistic-fit">Logistic fit</a></li>
<li><a href="section-example-implicit-equation.html" data-scroll="section-example-implicit-equation">Fitting an ellipse to data points</a></li>
<li><a href="exercises-transforming-data.html" data-scroll="exercises-transforming-data">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-nonlinear-least-squares.html" data-scroll="chapter-nonlinear-least-squares"><span class="codenumber">29</span> <span class="title">Nonlinear Least Squares</span></a><ul>
<li><a href="section-nls-motivation.html" data-scroll="section-nls-motivation">Motivating examples for Nonlinear Least Squares</a></li>
<li><a href="section-using-fminsearch-curvefit.html" data-scroll="section-using-fminsearch-curvefit">Using fminsearch for curve-fitting</a></li>
<li><a href="section-source-location.html" data-scroll="section-source-location">Beyond curve-fitting: source location</a></li>
<li><a href="section-logistic-curve.html" data-scroll="section-logistic-curve">A closer look at the logistic curve</a></li>
<li><a href="exercises-nonlinear-least-squares.html" data-scroll="exercises-nonlinear-least-squares">Homework</a></li>
</ul>
</li>
<li class="link part"><a href="part-optimization.html" data-scroll="part-optimization"><span class="codenumber">V</span> <span class="title">Optimization</span></a></li>
<li class="link">
<a href="chapter-single-variable-minimization.html" data-scroll="chapter-single-variable-minimization"><span class="codenumber">30</span> <span class="title">Single Variable Minimization</span></a><ul>
<li><a href="section-introduction-optimization.html" data-scroll="section-introduction-optimization">Basic concepts of optimization</a></li>
<li><a href="section-brute-force.html" data-scroll="section-brute-force">Brute force search</a></li>
<li><a href="section-newton-method-min.html" data-scroll="section-newton-method-min">Newton method for minimization</a></li>
<li><a href="section-golden-section.html" data-scroll="section-golden-section">Golden section search</a></li>
<li><a href="exercises-single-variable-minimization.html" data-scroll="exercises-single-variable-minimization">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-parabolic-interpolation-descent.html" data-scroll="chapter-parabolic-interpolation-descent"><span class="codenumber">31</span> <span class="title">Parabolic Interpolation and Gradient Descent</span></a><ul>
<li><a href="section-parabolic-interpolation.html" data-scroll="section-parabolic-interpolation">Successive parabolic interpolation</a></li>
<li><a href="section-gradient-descent-1d.html" data-scroll="section-gradient-descent-1d">Gradient descent in one dimension</a></li>
<li><a href="exercises-parabolic-interpolation-descent.html" data-scroll="exercises-parabolic-interpolation-descent">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-gradient-newton-conjugate.html" data-scroll="chapter-gradient-newton-conjugate"><span class="codenumber">32</span> <span class="title">Gradient methods and Newton's method</span></a><ul>
<li><a href="section-gradient-descent-nd.html" data-scroll="section-gradient-descent-nd">Gradient descent in several variables</a></li>
<li><a href="section-newton-method-min-nd.html" data-scroll="section-newton-method-min-nd">Newton's method for multivariate minimization</a></li>
<li><a href="section-conjugate-gradient.html" data-scroll="section-conjugate-gradient">Conjugate gradient method</a></li>
<li><a href="exercises-gradient-newton-conjugate.html" data-scroll="exercises-gradient-newton-conjugate">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-nelder-mead.html" data-scroll="chapter-nelder-mead"><span class="codenumber">33</span> <span class="title">The Nelder-Mead method</span></a><ul>
<li><a href="section-nelder-mead-reflect.html" data-scroll="section-nelder-mead-reflect">First attempt at derivative-free minimization</a></li>
<li><a href="section-nelder-mead-contract.html" data-scroll="section-nelder-mead-contract">Reflection-contraction combination</a></li>
<li><a href="section-nelder-mead-expand.html" data-scroll="section-nelder-mead-expand">Reflection-contraction-expansion Nelder-Mead method</a></li>
<li><a href="exercises-nelder-mead.html" data-scroll="exercises-nelder-mead">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-constrained-optimization.html" data-scroll="chapter-constrained-optimization"><span class="codenumber">34</span> <span class="title">Constrained Optimization</span></a><ul>
<li><a href="section-penalty-method.html" data-scroll="section-penalty-method" class="active">Penalty method</a></li>
<li><a href="section-lagrange-multiplier.html" data-scroll="section-lagrange-multiplier">Lagrange multiplier method</a></li>
<li><a href="exercises-constrained-optimization.html" data-scroll="exercises-constrained-optimization">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-linear-programming.html" data-scroll="chapter-linear-programming"><span class="codenumber">35</span> <span class="title">Linear Programming</span></a><ul>
<li><a href="section-linear-programming-introduction.html" data-scroll="section-linear-programming-introduction">Introduction to linear programming</a></li>
<li><a href="section-linear-programming-duality.html" data-scroll="section-linear-programming-duality">Duality in linear programming</a></li>
<li><a href="section-lp-duality-economic.html" data-scroll="section-lp-duality-economic">Interpretation of duality in microeconomics</a></li>
<li><a href="section-lp-duality-transportation.html" data-scroll="section-lp-duality-transportation">Duality in optimal transportation</a></li>
<li><a href="exercises-linear-programming.html" data-scroll="exercises-linear-programming">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-classification.html" data-scroll="chapter-classification"><span class="codenumber">36</span> <span class="title">Classification Problems</span></a><ul>
<li><a href="section-classification-logistic-regression.html" data-scroll="section-classification-logistic-regression">Classification and logistic regression</a></li>
<li><a href="section-classification-linear-programming.html" data-scroll="section-classification-linear-programming">Classification and linear programming</a></li>
<li><a href="exercises-classification.html" data-scroll="exercises-classification">Homework</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-penalty-method"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">34.1</span> <span class="title">Penalty method</span>
</h2>
<p id="p-926">A typical problem of constrained optimization is to find the minimum of a function \(f\) on some region \(D\) of \(\mathbb R^n\text{.}\) One approach is to add a penalty for being outside of \(D\text{,}\) for example let</p>
<div class="displaymath">
\begin{equation}
g(x) = \begin{cases} f(x)  &amp; x\in D \\ f(x) + M &amp; x\notin D \end{cases} \label{eq-constant-penalty}\tag{34.1.1}
\end{equation}
</div>
<p data-braille="continuation">where \(M\) is a large number, say \(10^6\text{.}\) Then try to minimize \(g\text{,}\) with the expectation that the minimum will be in \(D\text{.}\) Since \(g=f\) within \(D\text{,}\) such a minimum will also be a minimum of \(f\text{.}\)</p>
<p id="p-927">The <em class="emphasis">constant penalty</em> <a class="xref" data-knowl="./knowl/eq-constant-penalty.html" title="Equation 34.1.1">(34.1.1)</a> has several disadvantages. It makes \(g\) discontinuous, and it does not eliminate <em class="emphasis">local</em> minima outside of \(D\text{.}\) Since minimization methods often converge to a local minimum, we may end up outside of \(D\) even though there are much smaller values within \(D\text{.}\)</p>
<p id="p-928">A way to correct both of the above issues is to add to \(f\) a continuous penalty function \(P\) that is equal to \(0\) inside \(D\) and is positive outside of \(D\text{.}\) Then minimize \(f+P\text{.}\) One way to construct \(P\) is to describe the region \(D\) by way of an inequality \(c\le 0\text{,}\) for example \(x^2 + y^2 - 1 \le 0\) describes a disk of radius \(1\text{.}\) There are multiple ways to use such an inequality  to form a penalty function. For example, the linear penalty</p>
<div class="displaymath">
\begin{equation}
P_1(x) = M\max(0, c)\label{eq-linear-penalty}\tag{34.1.2}
\end{equation}
</div>
<p data-braille="continuation">(with a large constant \(M\)) and quadratic penalty</p>
<div class="displaymath">
\begin{equation}
P_2(x) = M\max(0, c)^2\label{eq-quadratic-penalty}\tag{34.1.3}
\end{equation}
</div>
<p data-braille="continuation">The linear penalty is continuous but not differentiable on the boundary of \(D\text{.}\) The quadratic penalty is differentiable, which is preferable for the methods that rely on the gradient. Indeed, the gradient of <a class="xref" data-knowl="./knowl/eq-quadratic-penalty.html" title="Equation 34.1.3">(34.1.3)</a>  is</p>
<div class="displaymath">
\begin{equation}
\nabla P_2(x) = 2 M \max(0, c) \nabla c\label{eq-quadratic-penalty-grad}\tag{34.1.4}
\end{equation}
</div>
<p data-braille="continuation">On the other hand, the fact that \(P_2\) starts off with zero slope makes it more likely that the minimum of \(f + P_2\) will be slightly outside of the region \(D\text{.}\) So there is a tradeoff between reaching the minimum and enforcing the constraint.</p>
<p id="p-929">Let us try both methods with a simple function: minimize \(f(x, y) = (x + 7y)^3\) on the disk \(x^2 + y^2\le 1\text{.}\) We could use our own implementation of Nelder-Mead method from <a href="chapter-nelder-mead.html" class="internal" title="Chapter 33: The Nelder-Mead method">Chapter 33</a> but <code class="code-inline tex2jax_ignore">fminsearch</code> already does that, so it is used below.</p>
<article class="example example-like" id="example-comparing-penalty-functions"><a data-knowl="" class="id-ref original" data-refid="hk-example-comparing-penalty-functions"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">34.1.1</span><span class="period">.</span><span class="space"> </span><span class="title">Comparing two penalty functions.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-comparing-penalty-functions"><article class="example example-like"><p id="p-930">Minimize  \(f(x, y) = (x + 7y)^3 \) on the disk \(x^2 + y^2\le 1\) by using <code class="code-inline tex2jax_ignore">fminsearch</code> with a penalty term.</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-solution-58" id="solution-58"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-58"><div class="solution solution-like">
<pre class="code-block tex2jax_ignore">f = @(x) (x(1) + 7*x(2)).^3;
c = @(x) x(1).^2 + x(2).^2 - 1;
M = 1e6;

x0 = randn(2, 1);
xm1 = fminsearch(@(x) f(x) + M*max(c(x), 0), x0);
xm2 = fminsearch(@(x) f(x) + M*max(c(x), 0).^2, x0);

fprintf('Linear penalty: found x = (%g, %g), |x| = %g, f(x) = %g \n', xm1, norm(xm1), f(xm1));
fprintf('Quadratic penalty: found x = (%g, %g), |x| = %g, f(x) = %g \n', xm2, norm(xm2), f(xm2));
</pre>
<p id="p-931">With the linear penalty, the minimization process sometimes fails to converge within the allowed attempts; but if it converges, it stays in the unit disk. With the quadratic penalty, the convergence is more reliable but the norm of the point of minimum is usually greater than \(1\text{.}\)</p>
</div></div>
</div></article></div>
<p id="p-932">In practice, quadratic penalty is usually preferable and the issue of the minimum being slightly out of bounds is dealt with by increasing \(M\) and using the previously found point of minimum as a new starting point. This is done below.</p>
<article class="example example-like" id="example-iterative-constrained-minimization"><a data-knowl="" class="id-ref original" data-refid="hk-example-iterative-constrained-minimization"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">34.1.2</span><span class="period">.</span><span class="space"> </span><span class="title">Iterative minimization on the unit disk.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-iterative-constrained-minimization"><article class="example example-like"><p id="p-933">Minimize  \(f(x, y) = (x + 7y)^3 \) on the disk \(x^2 + y^2\le 1\) by iteratively using <code class="code-inline tex2jax_ignore">fminsearch</code> with a quadratic penalty term.</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-solution-59" id="solution-59"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-59"><div class="solution solution-like">
<pre class="code-block tex2jax_ignore">f = @(x) (x(1) + 7*x(2)).^3;
c = @(x) x(1).^2 + x(2).^2 - 1;
x0 = randn(2, 1);

for M = [1e3, 1e6, 1e9, 1e12]
    x0 = fminsearch(@(x) f(x) + M*max(c(x), 0).^2, x0);
end
    
fprintf('Found x = (%g, %g), |x| = %g, f(x) = %g \n', x0, norm(x0), f(x0));
</pre>
<p id="p-934">With the linear penalty, the minimization process sometimes fails to converge within the allowed attempts; but if it converges, it stays in the unit disk. With the quadratic penalty, the convergence is more reliable but the norm of the point of minimum is usually greater than \(1\text{.}\)</p>
</div></div>
</div></article></div>
<p id="p-935">Note that the penalty method works just as well with <dfn class="terminology">equality constraints</dfn> of the form \(c = 0\text{.}\) In this case one adds \(Mc^2\) instead of \(M\max(c, 0)^2\) to the objective function. And if there are multiple constraints, they are all added.</p></section></div></main>
</div>
</body>
</html>
