<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2020-08-25T08:18:53-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Multivariate Newton's method</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link href="developer.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="numerical-methods.html"><span class="title">Numerical Methods with Programming</span></a></h1>
<p class="byline">Leonid Kovalev</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="section-nonlinear-systems.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chapter-multivariate-newton.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="section-multivariate-newton-method-issues.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="section-nonlinear-systems.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chapter-multivariate-newton.html" title="Up">Up</a><a class="next-button button toolbar-item" href="section-multivariate-newton-method-issues.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Front Matter</span></a><ul>
<li><a href="acknowledgement.html" data-scroll="acknowledgement">Acknowledgements</a></li>
<li><a href="preface.html" data-scroll="preface">Preface</a></li>
</ul>
</li>
<li class="link part"><a href="part-matlab.html" data-scroll="part-matlab"><span class="codenumber">I</span> <span class="title">Using Matlab</span></a></li>
<li class="link">
<a href="chapter-scalars-vectors-matrices.html" data-scroll="chapter-scalars-vectors-matrices"><span class="codenumber">1</span> <span class="title">Scalars, vectors and matrices</span></a><ul>
<li><a href="section-matlab-interface.html" data-scroll="section-matlab-interface">Matlab interface</a></li>
<li><a href="section-scalars.html" data-scroll="section-scalars">Assigning scalar values</a></li>
<li><a href="section-vectors-matrices.html" data-scroll="section-vectors-matrices">Creating vectors and matrices</a></li>
<li><a href="section-operations-vectors-matrices.html" data-scroll="section-operations-vectors-matrices">Operations on vectors and matrices</a></li>
<li><a href="section-indexing-vectors-matrices.html" data-scroll="section-indexing-vectors-matrices">Accessing the entries of vectors and matrices</a></li>
<li><a href="examples-matrices-vectors.html" data-scroll="examples-matrices-vectors">Examples and questions</a></li>
<li><a href="exercises-matrices-vectors.html" data-scroll="exercises-matrices-vectors">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-systems-vectorization-plots.html" data-scroll="chapter-systems-vectorization-plots"><span class="codenumber">2</span> <span class="title">Linear systems, array operations, plots</span></a><ul>
<li><a href="section-linear-systems.html" data-scroll="section-linear-systems">Systems of linear equations</a></li>
<li><a href="section-large-matrices.html" data-scroll="section-large-matrices">More tools for constructing matrices</a></li>
<li><a href="section-vectorization.html" data-scroll="section-vectorization">Array operations</a></li>
<li><a href="section-plotting.html" data-scroll="section-plotting">Plotting</a></li>
<li><a href="examples-systems-vectorization-plots.html" data-scroll="examples-systems-vectorization-plots">Examples and questions</a></li>
<li><a href="exercises-systems-vectorization-plots.html" data-scroll="exercises-systems-vectorization-plots">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-functions-input-output.html" data-scroll="chapter-functions-input-output"><span class="codenumber">3</span> <span class="title">Built-in functions, input, output</span></a><ul>
<li><a href="section-builtin-functions.html" data-scroll="section-builtin-functions">Built-in functions</a></li>
<li><a href="section-random-numbers-histograms.html" data-scroll="section-random-numbers-histograms">Random numbers and histograms</a></li>
<li><a href="section-user-input.html" data-scroll="section-user-input">User input</a></li>
<li><a href="section-formatted-output.html" data-scroll="section-formatted-output">Formatted output</a></li>
<li><a href="examples-functions-input-output.html" data-scroll="examples-functions-input-output">Examples and questions</a></li>
<li><a href="exercises-functions-input-output.html" data-scroll="exercises-functions-input-output">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-control-flow.html" data-scroll="chapter-control-flow"><span class="codenumber">4</span> <span class="title">Control flow: loops and conditional statements</span></a><ul>
<li><a href="section-for-loop.html" data-scroll="section-for-loop"><code class="code-inline tex2jax_ignore">for</code> loop</a></li>
<li><a href="section-while-loop.html" data-scroll="section-while-loop"><code class="code-inline tex2jax_ignore">while</code> loop</a></li>
<li><a href="section-if-statement.html" data-scroll="section-if-statement"><code class="code-inline tex2jax_ignore">if</code> statement</a></li>
<li><a href="section-break-statement.html" data-scroll="section-break-statement">Breaking out of a loop</a></li>
<li><a href="examples-control-flow.html" data-scroll="examples-control-flow">Examples and questions</a></li>
<li><a href="exercises-control-flow.html" data-scroll="exercises-control-flow">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-user-defined-functions.html" data-scroll="chapter-user-defined-functions"><span class="codenumber">5</span> <span class="title">User-defined functions</span></a><ul>
<li><a href="section-anonymous-functions.html" data-scroll="section-anonymous-functions">Anonymous functions</a></li>
<li><a href="section-named-functions.html" data-scroll="section-named-functions">Named functions</a></li>
<li><a href="examples-user-defined-functions.html" data-scroll="examples-user-defined-functions">Examples and questions</a></li>
<li><a href="exercises-user-defined-functions.html" data-scroll="exercises-user-defined-functions">Homework</a></li>
</ul>
</li>
<li class="link part"><a href="part-equations.html" data-scroll="part-equations"><span class="codenumber">II</span> <span class="title">Solving Equations</span></a></li>
<li class="link">
<a href="chapter-linear-systems.html" data-scroll="chapter-linear-systems"><span class="codenumber">6</span> <span class="title">Systems of linear equations</span></a><ul>
<li><a href="section-classification-linear-systems.html" data-scroll="section-classification-linear-systems">Classification of linear systems</a></li>
<li><a href="section-systems-without-free-variables.html" data-scroll="section-systems-without-free-variables">Systems without free variables</a></li>
<li><a href="section-systems-with-free-variables.html" data-scroll="section-systems-with-free-variables">Systems with free variables</a></li>
<li><a href="section-round-off.html" data-scroll="section-round-off">The effect of round-off-errors</a></li>
<li><a href="examples-linear-systems.html" data-scroll="examples-linear-systems">Examples and questions</a></li>
<li><a href="exercises-linear-systems.html" data-scroll="exercises-linear-systems">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-roots-bisection.html" data-scroll="chapter-roots-bisection"><span class="codenumber">7</span> <span class="title">Root finding: bisection</span></a><ul>
<li><a href="section-motivation-numeric-solution.html" data-scroll="section-motivation-numeric-solution">Motivation for solving equations numerically</a></li>
<li><a href="section-meaning-numeric-solution.html" data-scroll="section-meaning-numeric-solution">The meaning of a numeric solution</a></li>
<li><a href="section-bisection-method.html" data-scroll="section-bisection-method">Bisection method</a></li>
<li><a href="section-bisection-issues.html" data-scroll="section-bisection-issues">Limitations of the bisection method</a></li>
<li><a href="examples-roots-bisection.html" data-scroll="examples-roots-bisection">Examples and questions</a></li>
<li><a href="exercises-roots-bisection.html" data-scroll="exercises-roots-bisection">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-fixed-point-iteration.html" data-scroll="chapter-fixed-point-iteration"><span class="codenumber">8</span> <span class="title">Root finding: fixed point iteration</span></a><ul>
<li><a href="section-classification-fixed-points.html" data-scroll="section-classification-fixed-points">Classification of fixed points</a></li>
<li><a href="section-rewriting-fixed-point.html" data-scroll="section-rewriting-fixed-point">Rewriting equations in the fixed-point form</a></li>
<li><a href="section-rate-convergence.html" data-scroll="section-rate-convergence">The speed of convergence of fixed-point iteration</a></li>
<li><a href="examples-fixed-point-iteration.html" data-scroll="examples-fixed-point-iteration">Examples and questions</a></li>
<li><a href="exercises-fixed-point-iteration.html" data-scroll="exercises-fixed-point-iteration">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-newton-secant.html" data-scroll="chapter-newton-secant"><span class="codenumber">9</span> <span class="title">Newton's method and secant method</span></a><ul>
<li><a href="section-newton-method-intro.html" data-scroll="section-newton-method-intro">Newton's method</a></li>
<li><a href="section-newton-method-issues.html" data-scroll="section-newton-method-issues">Potential issues with Newton's method</a></li>
<li><a href="section-secant-method.html" data-scroll="section-secant-method">The secant method</a></li>
<li><a href="section-relaxation-parameter.html" data-scroll="section-relaxation-parameter">The relaxation parameter</a></li>
<li><a href="examples-newton-secant.html" data-scroll="examples-newton-secant">Examples and questions</a></li>
<li><a href="exercises-newton-secant.html" data-scroll="exercises-newton-secant">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-multivariate-newton.html" data-scroll="chapter-multivariate-newton"><span class="codenumber">10</span> <span class="title">Systems of several nonlinear equations: multivariate Newton's method</span></a><ul>
<li><a href="section-nonlinear-systems.html" data-scroll="section-nonlinear-systems">Systems of nonlinear equations</a></li>
<li><a href="section-multivariate-newton.html" data-scroll="section-multivariate-newton" class="active">Multivariate Newton's method</a></li>
<li><a href="section-multivariate-newton-method-issues.html" data-scroll="section-multivariate-newton-method-issues">Potential issues</a></li>
<li><a href="examples-multivariate-newton.html" data-scroll="examples-multivariate-newton">Examples and questions</a></li>
<li><a href="exercises-multivariate-newton.html" data-scroll="exercises-multivariate-newton">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-broyden.html" data-scroll="chapter-broyden"><span class="codenumber">11</span> <span class="title">Broyden's method</span></a><ul>
<li><a href="section-broyden-intro.html" data-scroll="section-broyden-intro">Idea of Broyden's method</a></li>
<li><a href="section-broyden-linear-algebra.html" data-scroll="section-broyden-linear-algebra">Outer products</a></li>
<li><a href="section-broyden-method.html" data-scroll="section-broyden-method">Details of Broyden's method</a></li>
<li><a href="examples-broyden.html" data-scroll="examples-broyden">Examples and questions</a></li>
<li><a href="exercises-broyden.html" data-scroll="exercises-broyden">Homework</a></li>
</ul>
</li>
<li class="link part"><a href="part-calculus.html" data-scroll="part-calculus"><span class="codenumber">III</span> <span class="title">Numerical Calculus</span></a></li>
<li class="link">
<a href="chapter-numerical-differentiation.html" data-scroll="chapter-numerical-differentiation"><span class="codenumber">12</span> <span class="title">Numerical Differentiation</span></a><ul>
<li><a href="section-differentiation-intro.html" data-scroll="section-differentiation-intro">Definition of derivative and the order of error</a></li>
<li><a href="section-loss-significance.html" data-scroll="section-loss-significance">Loss of significance</a></li>
<li><a href="section-symmetric-difference.html" data-scroll="section-symmetric-difference">Symmetric difference formulas</a></li>
<li><a href="section-richardson-extrapolation.html" data-scroll="section-richardson-extrapolation">Richardson extrapolation</a></li>
<li><a href="examples-numerical-differentiation.html" data-scroll="examples-numerical-differentiation">Examples and questions</a></li>
<li><a href="exercises-numerical-differentiation.html" data-scroll="exercises-numerical-differentiation">Homework</a></li>
</ul>
</li>
<li class="link">
<a href="chapter-trapezoid-midpoint.html" data-scroll="chapter-trapezoid-midpoint"><span class="codenumber">13</span> <span class="title">Numerical integration: basic rules</span></a><ul>
<li><a href="section-riemann-sums.html" data-scroll="section-riemann-sums">Riemann sums</a></li>
<li><a href="section-left-right-midpoint.html" data-scroll="section-left-right-midpoint">Left, right, midpoint rules</a></li>
</ul>
</li>
<li class="link part"><a href="part-data.html" data-scroll="part-data"><span class="codenumber">IV</span> <span class="title">Modeling Data</span></a></li>
<li class="link part"><a href="part-optimization.html" data-scroll="part-optimization"><span class="codenumber">V</span> <span class="title">Optimization</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="section-multivariate-newton"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">10.2</span> <span class="title">Multivariate Newton's method</span>
</h2>
<p id="p-340">Newton's method (<a href="section-newton-method-intro.html" class="internal" title="Section 9.1: Newton's method">Section 9.1</a>) is based on the idea of replacing a nonlinear function with its linear approximation, and solving the resulting linear equation. The linear approximation comes from the derivative. In the setting of several variables we have <dfn class="terminology">partial derivatives</dfn> which are arranged into the <dfn class="terminology">Jacobian matrix</dfn>. The \((i, j)\) entry of the Jacobian matrix is the derivative of the \(i\)th component of \(\mathbf F\) with respect to the \(j\)th component of \(\mathbf x\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
J = \begin{pmatrix} \partial F_1/\partial x_1 \amp \partial F_1/\partial x_2 \\
\partial F_2/\partial x_1 \amp \partial F_2/\partial x_2 \end{pmatrix}
\end{equation*}
</div>
<p data-braille="continuation">(or more rows/columns if there are more variables).</p>
<article class="example example-like" id="example-56"><a data-knowl="" class="id-ref original" data-refid="hk-example-56"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">10.2.1</span><span class="period">.</span><span class="space"> </span><span class="title">Find the Jacobian matrix.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-56"><article class="example example-like"><p id="p-341">Find the Jacobian matrix of the function <a class="xref" data-knowl="./knowl/eq-function-F.html" title="Equation 10.1.2">(10.1.2)</a>. Express it as an anonymous function in Matlab.</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-solution-18" id="solution-18"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-18"><div class="solution solution-like">
<p id="p-342">The Jacobian matrix is</p>
<div class="displaymath">
\begin{equation*}
J = \begin{pmatrix}
2x_1e^{3x_2} \amp 3x_1^2e^{3x_2}  \\ 
x_2-\cos(x_1+x_2^2) \amp x_1-2x_2\cos(x_1+x_2^2) 
\end{pmatrix} 
\end{equation*}
</div>
<p data-braille="continuation">As a Matlab function, it can be written as follows.</p>
<pre class="code-block tex2jax_ignore">J = @(x) [2*x(1)*exp(3*x(2)), 3*x(1)^2*exp(3*x(2)); 
          x(2) - cos(x(1) + x(2)^2), x(1) - 2*x(2)*cos(x(1) + x(2)^2)];
</pre>
<p id="p-343">The linebreak between matrix rows is optional but improves readability.</p>
</div></div>
</div></article></div>
<p id="p-344">The linear approximation to \(\mathbf F\) at a point \(\mathbf x\) is \(\mathbf F(\mathbf x + \mathbf h) \approx \mathbf F(\mathbf x) + J\mathbf h\) where \(J\mathbf h\) is a matrix-vector product.</p>
<article class="example example-like" id="example-linear-approx-multivariate"><a data-knowl="" class="id-ref original" data-refid="hk-example-linear-approx-multivariate"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">10.2.2</span><span class="period">.</span><span class="space"> </span><span class="title">Find the linear approximation.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-linear-approx-multivariate"><article class="example example-like"><p id="p-345">Find the linear approximation to function <a class="xref" data-knowl="./knowl/eq-function-F.html" title="Equation 10.1.2">(10.1.2)</a> using <code class="code-inline tex2jax_ignore">x = [2; -1]</code> and <code class="code-inline tex2jax_ignore">h = [0.3, 0.2]</code>. Compare the approximation to the actual value of <code class="code-inline tex2jax_ignore">F(x+h)</code>.</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-solution-19" id="solution-19"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-19"><div class="solution solution-like">
<pre class="code-block tex2jax_ignore">F = @(x) [x(1)^2*exp(3*x(2)) - 30; x(1)*x(2) - sin(x(1) + x(2)^2)];
J = @(x) [2*x(1)*exp(3*x(2)), 3*x(1)^2*exp(3*x(2)); 
          x(2) - cos(x(1) + x(2)^2), x(1) - 2*x(2)*cos(x(1) + x(2)^2)];

x = [2; -1];
h = [0.3; 0.2];
fprintf("Linear approximation: (%g, %g)\n", F(x) + J(x)*h)
fprintf("Actual value: (%g, %g)\n", F(x + h))
</pre>
<p id="p-346">The output:</p>
<pre class="code-block tex2jax_ignore">Linear approximation: (-29.6216, -2.14012)
Actual value: (-29.5201, -2.04023)
</pre>
<p id="p-347">These are close, so the approximation is good. Note the use of formatted strings with vectors: Matlab automatically “unpacks” vectors when they are used in <code class="code-inline tex2jax_ignore">fprintf</code>. This means one should have a formatting code for every entry of the vector, like <code class="code-inline tex2jax_ignore">(%g, %g)</code> above. The formatting code <code class="code-inline tex2jax_ignore">%g</code> without any specification of precision means the numbers are shown as Matlab would normally shows them.</p>
</div></div>
</div></article></div>
<p id="p-348">As with the single-variable Newton method, we equate the linear approximation to zero and solve the linear equation. The solution of \(\mathbf F(\mathbf x) + J\mathbf h=0\) is \(\mathbf h = -J^{-1} \mathbf F(\mathbf x)\text{.}\) This formula is only for writing down the theoretical approach, in practice we do not invert the matrix \(J\) and simply ask Matlab to solve the linear system (this is more efficient than computing the inverse matrix). So, in Matlab terms the formula is <code class="code-inline tex2jax_ignore">h = -J\F(x)</code>. Having found the vector \(\mathbf h\) we replace \(\mathbf x\) with \(\mathbf x + \mathbf h\) and repeat. The process stops when the steps becomes sufficiently small, indicating we approached a solution. The size of vectors is measured by their norm: <code class="code-inline tex2jax_ignore">norm(h)</code>.</p>
<p id="p-349">The typical behavior of Newton's method is that it jumps around for several steps, but once it gets in a neighborhood of a solution, it converges to it very quickly.</p>
<article class="example example-like" id="example-multivariate-newton-solve"><a data-knowl="" class="id-ref original" data-refid="hk-example-multivariate-newton-solve"><h6 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">10.2.3</span><span class="period">.</span><span class="space"> </span><span class="title">Solve a system using Newton's method.</span>
</h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-example-multivariate-newton-solve"><article class="example example-like"><p id="p-350">Solve the system <a class="xref" data-knowl="./knowl/eq-nonlinear-system.html" title="Equation 10.1.1">(10.1.1)</a> using Newton's method. Try different initial points. Does the method always converge? Does it converge to the same solution?</p>
<div class="solutions">
<a data-knowl="" class="id-ref original" data-refid="hk-solution-20" id="solution-20"><span class="type">Solution</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-20"><div class="solution solution-like">
<p id="p-351">Following the structure of single-variable Newton method with notational adjustments:</p>
<pre class="code-block tex2jax_ignore">F = @(x) [x(1)^2*exp(3*x(2)) - 30; x(1)*x(2) - sin(x(1) + x(2)^2)];
J = @(x) [2*x(1)*exp(3*x(2)), 3*x(1)^2*exp(3*x(2)); 
          x(2) - cos(x(1) + x(2)^2), x(1) - 2*x(2)*cos(x(1) + x(2)^2)];
      
x = [2; 1];
max_tries = 10000;

for k = 1:max_tries
    h = -J(x)\F(x);
    x = x + h;
    if norm(h) &lt; 100*eps(norm(x))
        break
    end
end

if k &lt; max_tries
    fprintf('Found a solution after %d steps:\n', k);
    disp(x)
    disp('The value F(x)')
    disp(F(x))
else
    disp('Failed to converge')
end
</pre>
<p id="p-352">It is reasonable to increase the “max tries” number in Newton's method when several variables are involved, as convergence may take longer. In the above example, with initial point <code class="code-inline tex2jax_ignore">[2; 1]</code>, a solution <code class="code-inline tex2jax_ignore">[-0.0019; 5.3185]</code> is found in 15 steps. With initial point <code class="code-inline tex2jax_ignore">[1; 2]</code> the method fails to converge. With initial point <code class="code-inline tex2jax_ignore">[2; 2]</code> it converges in 10 steps to a different solution, <code class="code-inline tex2jax_ignore">[-0.2734; 1.9982]</code>.</p>
</div></div>
</div></article></div></section></div></main>
</div>
</body>
</html>
