<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2021-10-16T16:38:48-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body>
<article class="exercise exercise-like"><h6 class="heading">
<span class="type">Exercise</span><span class="space"> </span><span class="codenumber">1<span class="period">.</span></span>
</h6>
<p>Consider the count of world-wide Covid cases (<a class="external" href="https://www.nytimes.com/interactive/2021/world/covid-cases.html" target="_blank">source</a>) from Fall 2020:</p>
<figure class="figure figure-like"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="images/covid_world.png" style="width: 100%; height: auto;" alt=""></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">29.4.1<span class="period">.</span></span><span class="space"> </span>New reported cases</figcaption></figure><p>The graph shows three stages of accelerated growth: March-April, June-July, and from October onward. Since the total reflects the spread of disease in different regions, it is natural that it looks like the sum of different logistic curves.</p>
<p>Accordingly, we try modeling this by the sum of three logistic curves. To reduce the amount of data, we use the 7-day averages reported on the 1st, 11th, and 21th of every month, from March 1 to November 21. These 27 data values (measured in thousands) are below.</p>
<pre class="code-block tex2jax_ignore">y = [1 4 21 67 80 79 77 85 94 110 126 148 180 205 230 257 259 254 265 267 292 295 337 389 503 573 588];
</pre>
<p>The corresponding x-values are simply <code class="code-inline tex2jax_ignore">x = 1:numel(y)</code>. Run <code class="code-inline tex2jax_ignore">plot(x, y, '*')</code> to visualize the data: this will help with choosing initial parameters, as described below.</p>
<p>High-dimensional optimization is difficult, and <code class="code-inline tex2jax_ignore">fminsearch</code> will need your help in the form of a good initial point (<code class="code-inline tex2jax_ignore">ones(9, 1)</code> is not good enough). The logistic equation <a class="xref" data-knowl="./knowl/eq-logistic-curve-shift.html" title="Equation 29.2.1">(29.2.1)</a> leads to the 9-parameter model</p>
<div class="displaymath">
\begin{equation}
y = \frac{M_1}{1 + e^{-(x-a_1)/s_1}} + \frac{M_2}{1 + e^{-(x-a_2)/s_2}} + \frac{M_3}{1 + e^{-(x-a_3)/s_3}}\tag{29.4.1}
\end{equation}
</div>
<p data-braille="continuation">Reasonable initial guesses would be:</p>
<ul class="disc">
<li>\(a_1, a_2, a_3\) are the x-values of places where the three “waves” are the steepest</li>
<li>\(M_1, M_2, M_3\) are the sizes of the three waves (how much each of them adds to the total)</li>
<li>\(s_1, s_2, s_3\) are about a tenth of the non-flat span of the wave.</li>
</ul>
<p>Follow the examples such as <a class="xref" data-knowl="./knowl/example-best-fit-logistic-nls.html" title="Example 29.2.1: Fit a logistic function to Covid data">Example 29.2.1</a> in plotting the best-fitting curve together with the data. Since the main interest in building a model like this is to predict future development, extend the curve by a month into the future (this means 3 units on x-axis). What does it predict for December 21?</p></article><span class="incontext"><a href="exercises-nonlinear-least-squares.html#exercise-69">in-context</a></span>
</body>
</html>
