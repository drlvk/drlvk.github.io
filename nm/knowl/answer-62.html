<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2021-03-20T15:30:57-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body>
<div class="answer solution-like">
<h6 class="heading">
<span class="type">Answer</span><span class="space"> </span><span class="codenumber">23.3.1.1</span><span class="period">.</span>
</h6>
<p>Since the number of critical points is not known in advance, we can gather them by appending each new critical point to the vector <code class="code-inline tex2jax_ignore">critpts</code>. To qualify for inclusion, a root of derivative of the cubic polynomial used on \([x_k, x_{k+1}]\) must be real and must lie within this interval.</p>
<pre class="code-block tex2jax_ignore">s = spline(x, y);
critpts = [];
for k=1:numel(x)-1
    r = roots([3 2 1].*s.coefs(k, 1:3));
    for j = 1:numel(r)
        if isreal(r(j)) &amp;&amp; r(j) &gt;= 0 &amp;&amp; r(j) &lt;= x(k+1)-x(k)
            critpts = [critpts, x(k)+r(j)];
        end
    end
end
t = linspace(min(x), max(x), 1000);
plot(t, ppval(s, t), x, y, 'r+', critpts, ppval(s, critpts), 'k*')
</pre>
<p>The script uses <code class="code-inline tex2jax_ignore">ppval</code> since the spline <code class="code-inline tex2jax_ignore">s</code> is already constructed; calling <code class="code-inline tex2jax_ignore">spline(x, y, ...)</code> repeatedly with the same <code class="code-inline tex2jax_ignore">x, y</code> seems wasteful.</p>
</div>
<span class="incontext"><a href="section-using-cubic-splines.html#answer-62">in-context</a></span>
</body>
</html>
