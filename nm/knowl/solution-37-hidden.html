<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2021-02-21T13:06:29-05:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body><div class="solution solution-like">
<p>Since <code class="code-inline tex2jax_ignore">ode45</code> returns <code class="code-inline tex2jax_ignore">y</code> as a column, it is transposed in the code below. Then we extend this vector to <code class="code-inline tex2jax_ignore">ye</code>, take its Fourier Transform <code class="code-inline tex2jax_ignore">c</code>, and fold it into cosine coefficients <code class="code-inline tex2jax_ignore">cf</code>. Then plot the resulting sum of cosines.</p>
<pre class="code-block tex2jax_ignore">[t, y] = ode45(@(t, y) sin(y^2) + t, 0:0.1:3, 1);
y = y';

n = numel(y);
ye = [y y(end-1:-1:2)];
c = real(fft(ye))/numel(ye);
cf = [c(1) 2*c(2:n-1) c(n)];

L = 3;
x = linspace(0, L, 1000);
k = 0:n-1;
g = cf*cos(k'*x*pi/L);
plot(x, g, t, y, 'r*')
</pre>
</div></body>
</html>
