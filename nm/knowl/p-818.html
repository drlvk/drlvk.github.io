<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2021-05-04T13:00:51-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body>
<h6 class="heading"><span class="type">Paragraph</span></h6>
<p>When we solve an overdetermined linear system \(Az=b\) as <code class="code-inline tex2jax_ignore">z = A\b</code>, the result is the least squares solution which minimizes the sum</p>
<div class="displaymath">
\begin{equation}
\sum_k ((Az)_k-b_k)^2\tag{28.3.1}
\end{equation}
</div>
<p data-braille="continuation">(the penalty). For example, the difference of \(0.1\) between \((Az)_k\) and \(b_k\) contributes \(0.01\) to the penalty, no matter what \(k\) is. But in some contexts we may want to treat different data points differently:</p>
<ul class="disc">
<li>We are more certain about some of the numbers \(b_k\) than others.</li>
<li>Some of the numbers are much larger than others, and we expect the absolute errors for them to be larger.</li>
<li>We applied some transformation to the data, like in the previous sections.</li>
</ul>
<p data-braille="continuation">In such cases we may want to introduce <em class="emphasis">weights</em> \(w_k\) (some positive numbers) and minimize the sum</p>
<div class="displaymath">
\begin{equation}
\sum_k ((Az)_k-b_k)^2 w_k^2\tag{28.3.2}
\end{equation}
</div>
<p data-braille="continuation">instead of <a class="xref" data-knowl="./knowl/eq-penalty-lsq.html" title="Equation 28.3.1">(28.3.1)</a>. Larger weights mean that we penalize the residuals (the differences between the model and the data) more. To solve this <em class="emphasis">weighted least squares</em> problem in Matlab, we need to multiply the first equation in \(Az=b\) by \(w_1\text{,}\) the second by \(w_2\text{,}\) and so on. To do this, arrange the weights into a column vector <code class="code-inline tex2jax_ignore">w</code> and let</p>
<pre class="code-block tex2jax_ignore">z = (A.*w)\(b.*w);</pre>
<p data-braille="continuation">The array operations <code class="code-inline tex2jax_ignore">.*</code> take care of multiplying each equation by its weight.</p>
<span class="incontext"><a href="section-weighted-least-squares.html#p-818">in-context</a></span>
</body>
</html>
